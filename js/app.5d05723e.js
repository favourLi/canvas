(function(t){function e(e){for(var r,c,l=e[0],a=e[1],s=e[2],u=0,d=[];u<l.length;u++)c=l[u],i[c]&&d.push(i[c][0]),i[c]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r]);h&&h(e);while(d.length)d.shift()();return o.push.apply(o,s||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,l=1;l<n.length;l++){var a=n[l];0!==i[a]&&(r=!1)}r&&(o.splice(e--,1),t=c(c.s=n[0]))}return t}var r={},i={app:0},o=[];function c(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=t,c.c=r,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)c.d(n,r,function(e){return t[e]}.bind(null,r));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="./";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],a=l.push.bind(l);l.push=e,l=l.slice();for(var s=0;s<l.length;s++)e(l[s]);var h=a;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},2856:function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("097d");var r=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("canvas",{attrs:{id:"canvas"}}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],attrs:{id:"show"}},[t._v(t._s(t.showText))])])},o=[],c=(n("a481"),{text:"root",level:0,childLen:50,children:[{text:"1",level:1,childLen:5,children:[{text:"2",level:2,childLen:0,children:[]},{text:"2",level:2,childLen:0,children:[]}]}]}),l=n("9393"),a=(n("55dd"),n("6c7b"),n("ac4d"),n("8a81"),n("ac6a"),n("c665")),s=n("aa9a"),h=function(){function t(e,n){var r=this;Object(a["a"])(this,t),this.data=e,this.parent=n,this.children=e.children,this.id=null,this.styles={color:"#2826f7"},this.numChild=e.childLen,this.order=null,this.angle=null,this.x=null,this.y=null,this.radius=null,this.rect=null,this.circleRadius=10;var i=0;Object.defineProperty(this,"radius",{set:function(t){if("number"===typeof t){i=t;var e=n?n.x:0,o=n?n.y:0;r.x=t*Math.cos(r.angle)+e,r.y=0-t*Math.sin(r.angle)+o}},get:function(){return i}},{enumerable:!0})}return Object(s["a"])(t,[{key:"refresh",value:function(){var t=this.parent?this.parent.x:0,e=this.parent?this.parent.y:0;this.x=this.radius*Math.cos(this.angle)+t,this.y=0-this.radius*Math.sin(this.angle)+e}}]),t}(),u=(n("c5f6"),function t(e,n){Object(a["a"])(this,t),this.x=e,this.y=n});Number.MAX_VALUE,Number.MIN_VALUE;function d(){this.name="Utils"}function f(t,e){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}function y(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function v(t,e){var n=!1;t.x>=e.rect[0].x&&t.x<=e.rect[1].x&&(n=!0);var r=!1;return t.y>=e.rect[0].y&&t.y<=e.rect[1].y&&(r=!0),n&&r}function x(t,e){var n=!1;t.x>=e.x-1.2*e.circleRadius&&t.x<=e.x+1.2*e.circleRadius&&(n=!0);var r=!1;return t.y>=e.y-1.2*e.circleRadius&&t.y<=e.y+1.2*e.circleRadius&&(r=!0),n&&r}function p(t,e){var n;return e.children&&e.children.length&&g(t,e.children)?e.children.map(function(e){v(t,e)&&(n=p(t,e))}):x(t,e)&&(n=e),n}function g(t,e){var n=!1;return e.map(function(e){e.children&&e.children.length&&g(t,e.children)&&(n=!0),v(t,e)&&(n=!0)}),n}function m(t,e,n){t.radius=40,t.children&&t.children.length&&t.children.map(function(e,n){m(e,t,n)}),C(t)}function w(t,e){e.children.sort(function(t,e){return t.order-e.order}).map(function(e){if(e!==t){var n=0;while(b(e,t)&&n<800)n++,e.radius+=1,N(_(e).children),C(_(e));while(R(t,e,e.parent)&&n<800)n++,e.radius+=1,t.radius+=1,N(_(e).children),C(_(e)),N(_(t).children),C(_(t))}}),t.children&&t.children.length&&t.children.map(function(e){w(e,t)})}function _(t){return 1!=t.data.level?_(t.parent):t}function b(t,e){var n=t.rect[0].x,r=e.rect[0].x,i=t.rect[1].x,o=e.rect[1].x,c=t.rect[0].y,l=e.rect[0].y,a=t.rect[1].y,s=e.rect[1].y,h=!1;(r>=n&&r<=i||o>=n&&o<=i)&&(h=!0);var u=!1;return(l>=c&&l<=a||s>=c&&s<=a)&&(u=!0),h&&u}function N(t){t.map(function(t){t.refresh(),t.children&&t.children.length&&N(t.children),C(t)})}function C(t){var e=[],n=new u(T(t,t.x),j(t,t.y)),r=new u(A(t,t.x),P(t,t.y));e.push(n,r),t.rect=e}function S(t){return t.sort(function(t,e){return t.numChild>e.numChild}).map(function(t,e){t.children&&(t.children=S(t.children)),t.order=e+1}),t}function M(t,e){var n=t.map(function(t){var n=new h(t,e);return n.children&&(n.children=M(n.children,n)),n});return n}function k(t,e){for(var n=t.length,r=0;r<n;r++)t[r].angle=e+2*Math.PI/n*r;t[0].order=n,t[0].x=t[0].order*Math.cos(t[0].angle),t[0].y=0-t[0].order*Math.sin(t[0].angle);for(var i=0;i<n;i++){for(var o=0,c=0,l=0;l<n;l++)t[l].order&&(o+=t[l].x,c+=t[l].y);for(var a=1e5,s=-1,h=n-i-1,u=0;u<n;u++)if(!t[u].order){var d=Math.abs(o+h*Math.cos(t[u].angle)),f=Math.abs(c-h*Math.sin(t[u].angle));d+f<a&&(s=u,a=d+f)}s>=0&&(t[s].order=h,t[s].x=t[s].order*Math.cos(t[s].angle),t[s].y=0-t[s].order*Math.sin(t[s].angle))}}function O(t,e,n){var r=!0,i=!1,o=void 0;try{for(var c,l=n[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var a=c.value;a.angle=t+(e-t)/(2*Math.PI)*a.angle}}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}}function R(t,e,n){var r=t.rect[0].x,i=t.rect[0].y,o=t.rect[1].x,c=t.rect[1].y,l=new u(r,i),a=new u(r,c),s=new u(o,c),h=new u(o,i),d=new u(e.x,e.y),f=new u(n.x,n.y);return!!(X(l,a,d,f)||X(a,s,d,f)||X(s,h,d,f)||X(h,l,d,f))}function X(t,e,n,r){var i=Y(t,e,n),o=Y(t,e,r),c=Y(n,r,t),l=Y(n,r,e);if(i*o>0||c*l>0)return!1;if(0==i&&0==o){var a=!1;(n.x>=t.x&&n.x<=e.x||n.x>=t.x&&r.x>=t.x)&&(a=!0);var s=!1;return(n.y>=t.y&&n.y<=e.y||n.y>=t.y&&r.y>=t.y)&&(s=!0),a&&s}return!0}function Y(t,e,n){var r=(n.x-t.x)*(e.y-t.y),i=(n.y-t.y)*(e.x-t.x);return r-i}function T(t,e){if(t.x-1.2*t.circleRadius<e&&(e=t.x-1.2*t.circleRadius),t.children&&t.children.length>0){var n=!0,r=!1,i=void 0;try{for(var o,c=t.children[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var l=o.value,a=T(l,e);a<e&&(e=a)}}catch(t){r=!0,i=t}finally{try{n||null==c.return||c.return()}finally{if(r)throw i}}}return e}function j(t,e){if(t.y-1.2*t.circleRadius<e&&(e=t.y-1.2*t.circleRadius),t.children&&t.children.length>0){var n=!0,r=!1,i=void 0;try{for(var o,c=t.children[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var l=o.value,a=j(l,e);a<e&&(e=a)}}catch(t){r=!0,i=t}finally{try{n||null==c.return||c.return()}finally{if(r)throw i}}}return e}function A(t,e){if(t.x+1.2*t.circleRadius>e&&(e=t.x+1.2*t.circleRadius),t.children&&t.children.length>0){var n=!0,r=!1,i=void 0;try{for(var o,c=t.children[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var l=o.value,a=A(l,e);a>e&&(e=a)}}catch(t){r=!0,i=t}finally{try{n||null==c.return||c.return()}finally{if(r)throw i}}}return e}function P(t,e){if(t.y+1.2*t.circleRadius>e&&(e=t.y+1.2*t.circleRadius),t.children&&t.children.length>0){var n=!0,r=!1,i=void 0;try{for(var o,c=t.children[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var l=o.value,a=P(l,e);a>e&&(e=a)}}catch(t){r=!0,i=t}finally{try{n||null==c.return||c.return()}finally{if(r)throw i}}}return e}d.__proto__.arrange=k,d.__proto__.shrinkAngle=O,d.__proto__.transfer2Node=M,d.__proto__.sortChildren=S,d.__proto__.setNodeAttr=m,d.__proto__.changeNodeAttr=w,d.__proto__.findNodeByCoord=p,d.__proto__.calcNodeRect=C,d.__proto__.getOrigin=f,d.__proto__.getDistance=y;n("0b16");var I=function(){function t(e){Object(a["a"])(this,t),this.styles={radius:40,activeColor:"#2826f7",notActiveColor:"#6d9eeb"},this.id=0,this.root=new h(e,null),this.root.id=this.id++,this.distance={},this.move={},this.moveTo={},this.origin={},this.scale=1,this.allScale=1}return Object(s["a"])(t,[{key:"addNodeId",value:function(t){var e=this;t.map(function(t){t.id=e.id++,t.children&&e.addNodeId(t.children)})}},{key:"angle",value:function(t,e){var n=t.children;if(t.children&&0!=t.children.length){for(var r=[],i=0;i<n.length;i++)r.push(new h(n[i],t));e?d.arrange(r,Math.PI/2):(d.arrange(r,Math.PI/r.length),d.shrinkAngle(t.angle-Math.PI/2,t.angle+Math.PI/2,r));for(var o=[],c=0;c<n.length;c++)for(var l=0;l<r.length;l++)n[c].order==r[l].order&&(o[l]=n[c],n[c].angle=r[l].angle);t.children=o;var a=!0,s=!1,u=void 0;try{for(var f,y=n[Symbol.iterator]();!(a=(f=y.next()).done);a=!0){var v=f.value;this.angle(v)}}catch(t){s=!0,u=t}finally{try{a||null==y.return||y.return()}finally{if(s)throw u}}}}},{key:"changeNodeColor",value:function(t){var e=this.styles.notActiveColor;this.root.styles.color=e,this.changeAllNodeColor(e,this.root);var n=this.styles.activeColor;t.styles.color=n,t.parent&&(t.parent.styles.color=n),t.children&&t.children.length&&t.children.map(function(t){t.styles.color=n})}},{key:"changeAllNodeColor",value:function(t,e){var n=this;e.styles.color=t,e.children&&e.children.length&&e.children.map(function(e){n.changeAllNodeColor(t,e)})}},{key:"start",value:function(){this.ctx.beginPath(),this.ctx.arc(this.root.x,this.root.y,this.root.circleRadius,0,2*Math.PI),this.ctx.fillStyle=this.root.styles.color,this.ctx.fill(),this.root.children.sort(function(t,e){return t.numChild<=e.numChild});var t=!0,e=!1,n=void 0;try{for(var r,i=this.root.children.entries()[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=Object(l["a"])(r.value,2),c=(o[0],o[1]);this.drawNode(c,this.root)}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"draw",value:function(t){var e=this;this.ch=window.getComputedStyle(t,!1).height.replace("px",""),this.cw=window.getComputedStyle(t,!1).width.replace("px",""),this.root.children=d.transfer2Node(this.root.children,this.root);var n=d.sortChildren(this.root.children);this.addNodeId(n),this.angle(this.root,!0),this.root.x=this.cw/2,this.root.y=this.ch/2;var r=!0,i=!1,o=void 0;try{for(var c,a=n.entries()[Symbol.iterator]();!(r=(c=a.next()).done);r=!0){var s=Object(l["a"])(c.value,2),h=s[0],u=s[1];d.setNodeAttr(u,this.root,h,40)}}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}var f=!0,y=!1,v=void 0;try{for(var x,p=n.entries()[Symbol.iterator]();!(f=(x=p.next()).done);f=!0){var g=Object(l["a"])(x.value,2);h=g[0],u=g[1];d.changeNodeAttr(u,this.root)}}catch(t){y=!0,v=t}finally{try{f||null==p.return||p.return()}finally{if(y)throw v}}d.calcNodeRect(this.root),this.canvas=t,this.ctx=t.getContext("2d"),this.start(),this.canvas.onclick=function(t){var n={x:t.clientX,y:t.clientY},r=d.findNodeByCoord(n,e.root);r&&(e.activeNode==r?(e.activeNode=null,e.changeAllNodeColor(e.styles.activeColor,e.root)):(e.activeNode=r,e.changeNodeColor(r)),e.show(r.id),e.clearCtx(),e.start())},this.canvas.ondblclick=function(t){e.origin={x:t.clientX,y:t.clientY},e.scale=1.2,e.setScaleNode(t.clientX,t.clientY)},this.canvas.oncontextmenu=function(t){e.origin={x:t.clientX,y:t.clientY},e.scale=1.2,e.setScaleNode(t.clientX,t.clientY)},this.canvas.ontouchstart=function(t){1===t.touches.length?e.move={x:t.touches[0].clientX,y:t.touches[0].clientY}:t.touches.length>1&&(e.distance.start=d.getDistance({x:t.touches[0].clientX,y:t.touches[0].clientY},{x:t.touches[1].clientX,y:t.touches[1].clientY}))},this.canvas.ontouchmove=function(t){1===t.touches.length?(e.moveTo={x:t.touches[0].clientX,y:t.touches[0].clientY},e.setTransform()):2===t.touches.length&&(e.distance.stop=d.getDistance({x:t.touches[0].clientX,y:t.touches[0].clientY},{x:t.touches[1].clientX,y:t.touches[1].clientY}),e.origin=d.getOrigin({x:t.touches[0].clientX/e.allScale,y:t.touches[0].clientY/e.allScale},{x:t.touches[1].clientX/e.allScale,y:t.touches[1].clientY/e.allScale}),e.scale=e.distance.stop/e.distance.start,e.distance.start=e.distance.stop,e.setScaleNode(t.clientX,t.clientY)),t.preventDefault()}}},{key:"setScaleNode",value:function(t,e){this.clearCtx(),this.root.circleRadius*=this.scale,this.allScale*=this.scale,this.root.x=t-(t-this.root.x)*this.scale,this.root.y=e-(e-this.root.y)*this.scale,this.scaleChildren(this.root.children,this.scale),d.calcNodeRect(this.root),this.start()}},{key:"scaleChildren",value:function(t,e){var n=this;t.map(function(t){t.radius*=e,t.circleRadius*=e,d.calcNodeRect(t),t.refresh(),t.children&&t.children.length&&n.scaleChildren(t.children,e)})}},{key:"setTransform",value:function(){this.clearCtx();var t=this.moveTo.x-this.move.x,e=this.moveTo.y-this.move.y;this.root.x+=t,this.root.y+=e,this.transfomNode(this.root.children,t,e),d.calcNodeRect(this.root),this.start(),this.move=this.moveTo}},{key:"transfomNode",value:function(t,e,n){var r=this;t.map(function(t){t.x+=e,t.y+=n,d.calcNodeRect(t),t.refresh(),t.children&&t.children.length&&r.transfomNode(t.children,e,n)})}},{key:"clearCtx",value:function(){var t=this.root.rect[0].x,e=this.root.rect[0].y,n=this.root.rect[1].x,r=this.root.rect[1].y;this.ctx.clearRect(t,e,Math.abs(n-t),Math.abs(r-e))}},{key:"drawNode",value:function(t,e){if(this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.circleRadius,0,2*Math.PI),this.ctx.fillStyle=t.styles.color,this.ctx.fill(),this.ctx.moveTo(t.x,t.y),this.ctx.lineTo(e.x,e.y),this.ctx.save(),this.ctx.fillStyle="#ffffff",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.font="12px sans-serif",this.ctx.fillText(t.id,t.x,t.y),this.ctx.globalCompositeOperation="destination-over",this.ctx.stroke(),this.ctx.restore(),t.children){t.children.sort(function(t,e){return t.numChild>e.numChild});var n=!0,r=!1,i=void 0;try{for(var o,c=t.children.entries()[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var a=Object(l["a"])(o.value,2),s=(a[0],a[1]);this.drawNode(s,t)}}catch(t){r=!0,i=t}finally{try{n||null==c.return||c.return()}finally{if(r)throw i}}}}}]),t}(),L=function t(){Object(a["a"])(this,t),this.name="Touch"},D={},E={},B={},U={},J=1;function V(t){switch(t.type){case"touchstart":1===t.touches.length?(E={x:t.touches[0].clientX,y:t.touches[0].clientY},U={x:t.touches[0].clientX,y:t.touches[0].clientY}):t.touches.length>1&&(D.start=getDistance({x:t.touches[0].clientX,y:t.touches[0].clientY},{x:t.touches[1].clientX,y:t.touches[1].clientY}));break;case"touchmove":1===t.touches.length?(B={x:t.touches[0].clientX,y:t.touches[0].clientY},L.setTransform()):2===t.touches.length&&(D.stop=getDistance({x:t.touches[0].clientX,y:t.touches[0].clientY},{x:t.touches[1].clientX,y:t.touches[1].clientY}),U=getOrigin({x:t.touches[0].clientX,y:t.touches[0].clientY},{x:t.touches[1].clientX,y:t.touches[1].clientY}),J=D.stop/D.start,D.start=D.stop,L.setScaleAnimation());break;case"touchend":break;case"touchcancel":J=1,L.setScaleAnimation();break;default:}}function $(){console.log(this.ctx),this.ctx.scale(J,J),J,this.ctx.translate(-(U.x*J-U.x)/J,-(U.y*J-U.y)/J)}function q(){var t=B.x-E.x,e=B.y-E.y;console.log(t,e),this.ctx.translate(3,3),E=B}L.__proto__.handleTouch=V,L.__proto__.setScaleAnimation=$,L.__proto__.setTransform=q;var z={name:"app",data:function(){return{showText:"",show:!1,t:null}},mounted:function(){var t=new I(c);window.charts=t;var e=document.getElementById("canvas"),n=document.getElementById("app"),r=window.getComputedStyle(n,!1).width.replace("px",""),i=window.getComputedStyle(n,!1).height.replace("px","");e.getContext("2d");e.width=r,e.height=i,t.draw(e),t.__proto__.show=this.showPop,document.addEventListener("touchmove",function(t){t.cancelable&&t.defaultPrevented&&t.preventDefault()})},methods:{showPop:function(t){var e=this;this.show=!0,this.showText=t,this.t&&clearTimeout(this.t),this.t=setTimeout(function(){e.show=!1},1500)}}},F=z,G=(n("5c0b"),n("2877")),H=Object(G["a"])(F,i,o,!1,null,null,null);H.options.__file="App.vue";var K=H.exports;r["a"].config.productionTip=!1,new r["a"]({render:function(t){return t(K)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var r=n("2856"),i=n.n(r);i.a}});
//# sourceMappingURL=app.5d05723e.js.map